create view PTS_SALES_REGISTER as
	select * from (
SELECT OI."DocEntry" AS "DocEntry", (CASE WHEN N2."BeginStr" IS NULL AND N2."EndStr" IS NULL THEN (IFNULL(N2."SeriesName", n'') || '/' || CAST(OI."DocNum" AS char(20))) ELSE N2."BeginStr" || CAST(OI."DocNum" AS char(4)) || N2."EndStr" END) AS "Invoice No", OI."DocDate"  "Invoice Date",  (SELECT STRING_AGG(t0."DocNum", ',') AS "SO" FROM (SELECT DISTINCT "ODLN"."DocNum" FROM "ODLN" "ODLN" INNER JOIN INV1 INV1 ON INV1."BaseEntry" = "ODLN"."DocEntry" AND INV1."DocEntry" = oi."DocEntry") AS "T0") AS "DEL No", (SELECT STRING_AGG(t0."DocDate", ',') AS "SO" FROM (SELECT DISTINCT TO_NVARCHAR(TO_DATE("ODLN"."DocDate"), 'YYYY-MM-DD') AS "DocDate" FROM "ODLN" "ODLN" INNER JOIN INV1 INV1 ON INV1."BaseEntry" = "ODLN"."DocEntry" AND INV1."DocEntry" = oi."DocEntry") AS "T0") AS "DEL Date", '' AS "Customer Ref Date", OI."CardCode" AS "Customer Code", OI."CardName" AS "Customer Name", (SELECT SUM(INV1."Quantity" * (CASE WHEN INV1."Currency" = 'INR' AND OINV."DocCur" = 'INR' THEN (INV1."PriceBefDi") WHEN INV1."Currency" <> 'INR' AND OINV."DocCur" <> 'INR' THEN (INV1."Rate" * INV1."PriceBefDi") WHEN INV1."Currency" <> 'INR' AND OINV."DocCur" = 'INR' THEN (INV1."Rate" * INV1."PriceBefDi") WHEN INV1."Currency" = 'INR' AND OINV."DocCur" <> 'INR' THEN (OINV."DocRate" * INV1."PriceBefDi") END)) FROM INV1 INNER JOIN OINV ON INV1."DocEntry" = OINV."DocEntry" WHERE INV1."DocEntry" = oi."DocEntry" GROUP BY INV1."DocEntry", OINV."DocCur") AS "Value Before Disc", (SELECT SUM(INV1."Quantity" * (CASE WHEN INV1."Currency" = 'INR' AND OINV."DocCur" = 'INR' THEN (INV1."Price") WHEN INV1."Currency" <> 'INR' AND OINV."DocCur" <> 'INR' THEN (INV1."Rate" * INV1."Price") WHEN INV1."Currency" <> 'INR' AND OINV."DocCur" = 'INR' THEN (INV1."Rate" * INV1."Price") WHEN INV1."Currency" = 'INR' AND OINV."DocCur" <> 'INR' THEN (OINV."DocRate" * INV1."Price") END)) FROM INV1 INNER JOIN OINV ON INV1."DocEntry" = OINV."DocEntry" WHERE INV1."DocEntry" = oi."DocEntry" GROUP BY INV1."DocEntry", OINV."DocCur") AS "Value After Disc", (SELECT (CASE WHEN OINV."DocCur" = 'INR' THEN SUM(IFNULL(INV1."LineTotal", 0)) ELSE SUM(IFNULL(INV1."TotalSumSy", 0)) END) FROM INV1 INNER JOIN OINV ON INV1."DocEntry" = OINV."DocEntry" WHERE INV1."DocEntry" = oi."DocEntry" GROUP BY INV1."DocEntry", OINV."DocCur") AS "Taxable Amt before Ex Ser Tax", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISTax."ISTax", 0) ELSE IFNULL(ISTax."ISTaxFC", 0) END) AS "Service Tax ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IExDuty."IExDuty", 0) ELSE IFNULL(IExDuty."IExDutyFC", 0) END) AS "Excise Duty ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ItmAED."ItmAED", 0) ELSE IFNULL(ItmAED."ItmAEDFC", 0) END) AS "AED ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH."ICeH", 0) ELSE IFNULL(ICeH."ICeHFC", 0) END) + (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH1."ICeH1", 0) ELSE IFNULL(ICeH1."ICeH1FC", 0) END) AS "Cess HeCess ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IEXD.IEXD, 0) ELSE IFNULL(IEXD.IEXDFC, 0) END) AS "EXD ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IKKCess."IKKCess", 0) ELSE IFNULL(IKKCess."IKKCessFC", 0) END) AS "KKCess ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISBCess."ISBCess", 0) ELSE IFNULL(ISBCess."ISBCessFC", 0) END) AS "SBCess ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IHSCess_ST."IHSCess_ST", 0) ELSE IFNULL(IHSCess_ST."IHSCess_STFC", 0) END) AS "HSCess ST ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISED.ISED, 0) ELSE IFNULL(ISED.ISEDFC, 0) END) AS "SED ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICess_ST."ICess_ST", 0) ELSE IFNULL(ICess_ST."ICess_STFC", 0) END) AS "ICess ST ItemL", IFNULL(ItmVAT."ItmVAT", 0) AS "VAT ItemL", IFNULL(ItmCST."ItmCST", 0) AS "CST ItemL", IFNULL(LLFreTot."LLFreTot", 0) AS "Total Fright ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISTaxD."ISTax", 0) ELSE IFNULL(ISTaxD."ISTaxFC", 0) END) AS "Service Tax ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IExDutyD."IExDuty", 0) ELSE IFNULL(IExDutyD."IExDutyFC", 0) END) AS "Excise Duty ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ItmAEDD."ItmAED", 0) ELSE IFNULL(ItmAEDD."ItmAEDFC", 0) END) AS "AED ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeHD."ICeH", 0) ELSE IFNULL(ICeHD."ICeHFC", 0) END) + (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH1D."ICeH1", 0) ELSE IFNULL(ICeH1D."ICeH1FC", 0) END) AS "Cess HeCess ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IEXDD.IEXD, 0) ELSE IFNULL(IEXDD.IEXDFC, 0) END) AS "EXD ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IKKCessD."IKKCess", 0) ELSE IFNULL(IKKCessD."IKKCessFC", 0) END) AS "KKCess ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISBCessD."ISBCess", 0) ELSE IFNULL(ISBCessD."ISBCessFC", 0) END) AS "SBCess ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IHSCess_STD."IHSCess_ST", 0) ELSE IFNULL(IHSCess_STD."IHSCess_STFC", 0) END) AS "HSCess ST ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISEDD.ISED, 0) ELSE IFNULL(ISEDD.ISEDFC, 0) END) AS "SED ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICess_STDD."ICess_ST", 0) ELSE IFNULL(ICess_STDD."ICess_STFC", 0) END) AS "ICess ST ItemL Fre", IFNULL(ItmVATD."ItmVAT", 0) AS "VAT ItemL Fre", IFNULL(ItmCSTDD."ItmCST", 0) AS "CST ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISTaxDoc."ISTax", 0) ELSE IFNULL(ISTaxDoc."ISTaxFC", 0) END) AS "Service Tax DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IExDutyDoc."IExDuty", 0) ELSE IFNULL(IExDutyDoc."IExDutyFC", 0) END) AS "Excise Duty DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ItmAEDDoc."ItmAED", 0) ELSE IFNULL(ItmAEDDoc."ItmAEDFC", 0) END) AS "AED DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeHDoc."ICeH", 0) ELSE IFNULL(ICeHDoc."ICeHFC", 0) END) + (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH1Doc."ICeH1", 0) ELSE IFNULL(ICeH1Doc."ICeH1FC", 0) END) AS "Cess HeCess DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IEXDDoc.IEXD, 0) ELSE IFNULL(IEXDDoc.IEXDFC, 0) END) AS "EXD DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IKKCessDoc."IKKCess", 0) ELSE IFNULL(IKKCessDoc."IKKCessFC", 0) END) AS "KKCess DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISBCessDoc."ISBCess", 0) ELSE IFNULL(ISBCessDoc."ISBCessFC", 0) END) AS "SBCess DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IHSCess_STDoc."IHSCess_ST", 0) ELSE IFNULL(IHSCess_STDoc."IHSCess_STFC", 0) END) AS "HSCess ST DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISEDDoc.ISED, 0) ELSE IFNULL(ISEDDoc.ISEDFC, 0) END) AS "SED DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICess_STDoc."ICess_ST", 0) ELSE IFNULL(ICess_STDoc."ICess_STFC", 0) END) AS "ICess ST DocL", IFNULL(ItmVATDoc."ItmVAT", 0) AS "VAT DocL", IFNULL(ItmCSTDoc."ItmCST", 0) AS "CST DocL", IFNULL(DocLevFreight."DocLevFreight", 0) AS "Total Fright DocL", Oi."DiscPrcnt" AS "Discount Percentage", (CASE WHEN OI."DocCur" = 'INR' THEN IFNULL(OI."DiscSum", 0) ELSE IFNULL(OI."DiscSumSy", 0) END) AS "Discount Amount", oi."RoundDif" AS "Round Off", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(Oi."DocTotal", 0) ELSE IFNULL(Oi."DocTotalSy", 0) END) AS "Doc Total", Oi."Comments" AS "Remarks", OI."DocCur" AS "Currency", oi."DocTotalFC" AS "DocTotal FC" FROM "OINV" oi INNER JOIN INV1 i1 ON OI."DocEntry" = I1."DocEntry" LEFT OUTER JOIN OSTC O ON O."Code" = I1."TaxCode" LEFT OUTER JOIN ODLN OD ON I1."BaseEntry" = OD."DocEntry" LEFT OUTER JOIN NNM1 N1 ON N1."Series" = OD."Series" LEFT OUTER JOIN NNM1 N2 ON N2."Series" = OI."Series" LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISTax", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISTaxFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 5 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISTax ON I1."DocEntry" = ISTax."DocEntry" AND ISTax."TaxType" IN (5) AND ISTax."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IExDuty", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IExDutyFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -90 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType") AS IExDuty ON I1."DocEntry" = IExDuty."DocEntry" AND IExDuty."TaxType" IN (-90) AND IExDuty."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IEXD", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IEXDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 10 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IEXD ON I1."DocEntry" = IEXD."DocEntry" AND IEXD."TaxType" IN (10) AND IEXD."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", MAX(INV4."TaxRate") AS "TaxRate", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IKKCess", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IKKCessFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 8 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IKKCess ON I1."DocEntry" = IKKCess."DocEntry" AND IKKCess."TaxType" IN (8) AND IkkCess."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISBCess", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISBCessFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 9 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISBCess ON I1."DocEntry" = ISBCess."DocEntry" AND ISBCess."TaxType" IN (9) AND IsbCess."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IHSCess_ST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IHSCess_STFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -10 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IHSCess_ST ON I1."DocEntry" = IHSCess_ST."DocEntry" AND IHSCess_ST."TaxType" IN (-10) AND IHSCess_ST."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISED", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISEDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -70 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISED ON I1."DocEntry" = ISED."DocEntry" AND ISED."TaxType" IN (-70) AND ISED."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICess_ST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICess_STFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 6 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICess_ST ON I1."DocEntry" = ICess_ST."DocEntry" AND ICess_ST."TaxType" IN (6) AND Icess_ST."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmAED", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmAEDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -80 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."TaxSumSys", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmAED ON I1."DocEntry" = ItmAED."DocEntry" AND ItmAED."TaxType" IN (-80) AND ItmAED."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICeH", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICeHFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -60) AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICeH ON I1."DocEntry" = ICeH."DocEntry" AND ICeH."TaxType" IN (-60) AND ICeH."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICeH1", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICeH1FC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -55) AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICeH1 ON I1."DocEntry" = ICeH1."DocEntry" AND ICeH1."TaxType" IN (-55) AND ICeH1."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."RelateType", SUM(INV4."TaxSum") AS "ITaxTot" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."RelateType") AS ITaxTot ON I1."DocEntry" = ITaxTot."DocEntry" AND ITaxTot."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmVAT", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmVATFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 1 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmVAT ON I1."DocEntry" = ItmVAT."DocEntry" AND ItmVAT."TaxType" IN (1) AND ItmVAT."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmCST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmCSTFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 4 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmCST ON I1."DocEntry" = ItmCST."DocEntry" AND ItmCST."TaxType" IN (4) AND ItmCST."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmVATCST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmVATCSTFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" IN (4,1) AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND INV4."ExpnsCode" = -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmVATCST ON I1."DocEntry" = ItmVATCST."DocEntry" AND ItmVATCST."TaxType" IN (4,1) AND ItmVATCST."RelateType" = 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISTax", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISTaxFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 5 AND INV4."RelateType" = 3 GROUP BY INV4."TaxSumSys", INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISTaxDoc ON I1."DocEntry" = ISTaxDoc."DocEntry" AND ISTaxDoc."TaxType" IN (5) AND ISTaxDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IExDuty", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IExDutyFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -90 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType") AS IExDutyDoc ON I1."DocEntry" = IExDutyDoc."DocEntry" AND IExDutyDoc."TaxType" IN (-90) AND IExDutyDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IEXD", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IEXDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 10 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IEXDDoc ON I1."DocEntry" = IEXDDoc."DocEntry" AND IEXDDoc."TaxType" IN (10) AND IEXDDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", MAX(INV4."TaxRate") AS "TaxRate", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IKKCess", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IKKCessFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 8 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IKKCessDoc ON I1."DocEntry" = IKKCessDoc."DocEntry" AND IKKCessDoc."TaxType" IN (8) AND IkkCessDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISBCess", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISBCessFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 9 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISBCessDoc ON I1."DocEntry" = ISBCessDoc."DocEntry" AND ISBCessDoc."TaxType" IN (9) AND IsbCessDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IHSCess_ST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IHSCess_STFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -10 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IHSCess_STDoc ON I1."DocEntry" = IHSCess_STDoc."DocEntry" AND IHSCess_STDoc."TaxType" IN (-10) AND IHSCess_STDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISED", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISEDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -70 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISEDDoc ON I1."DocEntry" = ISEDDoc."DocEntry" AND ISEDDoc."TaxType" IN (-70) AND ISEDDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICess_ST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICess_STFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 6 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICess_STDoc ON I1."DocEntry" = ICess_STDoc."DocEntry" AND ICess_STDoc."TaxType" IN (6) AND ICess_STDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmAED", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmAEDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -80 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmAEDDoc ON I1."DocEntry" = ItmAEDDoc."DocEntry" AND ItmAEDDoc."TaxType" IN (-80) AND ItmAEDDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICeH", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICeHFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -60) AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICeHDoc ON I1."DocEntry" = ICeHDoc."DocEntry" AND ICeHDoc."TaxType" IN (-60) AND ICeHDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICeH1", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICeH1FC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -55) AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICeH1Doc ON I1."DocEntry" = ICeH1Doc."DocEntry" AND ICeH1Doc."TaxType" IN (-55) AND ICeH1Doc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."RelateType", SUM(INV4."TaxSum") AS "ITaxTot" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."RelateType") AS ITaxTotDoc ON I1."DocEntry" = ITaxTotDoc."DocEntry" AND ITaxTotDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmVAT", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmVATFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 1 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmVATDoc ON I1."DocEntry" = ItmVATDoc."DocEntry" AND ItmVATDoc."TaxType" IN (1) AND ItmVATDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmCST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmCSTFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 4 AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmCSTDoc ON I1."DocEntry" = ItmCSTDoc."DocEntry" AND ItmCSTDoc."TaxType" IN (4) AND ItmCSTDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmVATCST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmVATCSTFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" IN (4,1) AND INV4."RelateType" = 3 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmVATCSTDoc ON I1."DocEntry" = ItmVATCSTDoc."DocEntry" AND ItmVATCSTDoc."TaxType" IN (4,1) AND ItmVATCSTDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISTax", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISTaxFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 5 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND cast(INV4."ExpnsCode" as varchar) <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISTaxD ON I1."DocEntry" = ISTaxD."DocEntry" AND ISTaxD."TaxType" IN (5) AND ISTaxD."RelateType" <> 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IExDuty", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IExDutyFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId"
 WHERE OSTT."AbsId" = -90 AND INV4."GroupNum" = -1 AND INV4."RelateType" = 1 AND cast(INV4."ExpnsCode" as varchar)<> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType") AS IExDutyD ON I1."DocEntry" = IExDutyD."DocEntry" AND IExDutyD."TaxType" IN (-90) AND IExDutyD."RelateType" <> 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IEXD", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IEXDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 10 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType") AS IEXDD ON I1."DocEntry" = IEXDD."DocEntry" AND IEXDD."TaxType" IN (10) AND IEXDD."RelateType" <> 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", MAX(INV4."TaxRate") AS "TaxRate", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IKKCess", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IKKCessFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 8 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IKKCessD ON I1."DocEntry" = IKKCessD."DocEntry" AND IKKCessD."TaxType" IN (8) AND IKKCessD."RelateType" <> 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISBCess", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISBCessFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 9 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISBCessD ON I1."DocEntry" = ISBCessD."DocEntry" AND ISBCessD."TaxType" IN (9) AND ISBCessD."RelateType" <> 1 LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "IHSCess_ST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "IHSCess_STFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -10 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS IHSCess_STD ON I1."DocEntry" = IHSCess_STD."DocEntry" AND IHSCess_STD."TaxType" IN (-10) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ISED", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ISEDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -70 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ISEDD ON I1."DocEntry" = ISEDD."DocEntry" AND ISEDD."TaxType" IN (-70) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICess_ST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICess_STFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 6 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICess_STDD ON I1."DocEntry" = ICess_STDD."DocEntry" AND ICess_STDD."TaxType" IN (6) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmAED", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmAEDFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -80 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmAEDD ON I1."DocEntry" = ItmAEDD."DocEntry" AND ItmAEDD."TaxType" IN (-80) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICeH", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICeHFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -60) AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICeHD ON I1."DocEntry" = ICeHD."DocEntry" AND ICeHD."TaxType" IN (-60) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ICeH1", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ICeH1FC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -55) AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ICeH1D ON I1."DocEntry" = ICeH1D."DocEntry" AND ICeH1D."TaxType" IN (-55) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."RelateType", SUM(INV4."TaxSum") AS "ITaxTot" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."RelateType") AS ITaxTotD ON I1."DocEntry" = ITaxTotD."DocEntry" LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmVAT", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmVATFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 1 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmVATD ON I1."DocEntry" = ItmVATD."DocEntry" AND ItmVATD."TaxType" IN (1) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmCST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmCSTFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 4 AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmCSTDD ON I1."DocEntry" = ItmCSTDD."DocEntry" AND ItmCSTDD."TaxType" IN (4) LEFT OUTER JOIN (SELECT INV4."DocEntry", INV4."staType" AS "TaxType", INV4."RelateType", SUM(IFNULL((INV4."TaxSum"), 0)) AS "ItmVATCST", SUM(IFNULL((INV4."TaxSumSys"), 0)) AS "ItmVATCSTFC" FROM INV4 INNER JOIN OSTT ON INV4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" IN (4,1) AND INV4."GroupNum" <> -1 AND INV4."RelateType" <> 1 AND INV4."ExpnsCode" <> -1 GROUP BY INV4."DocEntry", INV4."staType", INV4."RelateType", INV4."GroupNum") AS ItmVATCSTDD ON I1."DocEntry" = ItmVATCSTDD."DocEntry" AND ItmVATCSTDD."TaxType" IN (4,1) LEFT OUTER JOIN (SELECT INV2."DocEntry", SUM(CASE WHEN INV2."FixCurr" = 'INR' THEN IFNULL((INV2."LineTotal"), 0) ELSE IFNULL((INV2."TotalSumSy"), 0) END) AS "LLFreTot" FROM INV2 WHERE cast(INV2."ExpnsCode" as varchar) <> '' GROUP BY INV2."DocEntry") AS LLFreTot ON I1."DocEntry" = LLFreTot."DocEntry" LEFT OUTER JOIN (SELECT INV3."DocEntry", SUM(CASE WHEN INV3."FixCurr" = 'INR' THEN IFNULL((INV3."LineTotal"), 0) ELSE IFNULL((INV3."TotalSumSy"), 0) END) AS "DocLevFreight" FROM INV3 WHERE cast(INV3."ExpnsCode" as varchar) <> '' GROUP BY INV3."DocEntry") AS DocLevFreight ON I1."DocEntry" = DocLevFreight."DocEntry" LEFT OUTER JOIN (SELECT "CardCode", "Address", "TaxId0", "TaxId1", "TaxId2", "TaxId3" FROM CRD7 crd7 WHERE "Address" <> '' AND ("AddrType" = 'S')) AS crd7 ON OI."CardCode" = crd7."CardCode" AND OI."ShipToCode" = crd7."Address" WHERE OI.CANCELED = 'N'
--------------------------------------------------------------------------------------------------------------------------
union all
SELECT OI."DocEntry" AS "DocEntry", (CASE WHEN N2."BeginStr" IS NULL AND N2."EndStr" IS NULL THEN (IFNULL(N2."SeriesName", n'') || '/' || CAST(OI."DocNum" AS char(20))) 
ELSE N2."BeginStr" || CAST(OI."DocNum" AS char(4)) || N2."EndStr" END) AS "Invoice No", OI."DocDate"  "Invoice Date", 
(SELECT STRING_AGG(t0."DocNum", ',') AS "SO" FROM (SELECT DISTINCT ODLN."DocNum" FROM ODLN ODLN INNER JOIN RIN1 RIN1 ON RIN1."BaseEntry" = ODLN."DocEntry" AND RIN1."DocEntry" = oi."DocEntry") AS "T0") AS "DEL No", (SELECT STRING_AGG(t0."DocDate", ',') AS "SO" FROM (SELECT DISTINCT TO_NVARCHAR(TO_DATE(ODLN."DocDate"), 'YYYY-MM-DD') AS "DocDate" FROM ODLN ODLN INNER JOIN RIN1 RIN1 ON RIN1."BaseEntry" = ODLN."DocEntry" AND RIN1."DocEntry" = oi."DocEntry") AS "T0") AS "DEL Date", '' AS "Customer Ref Date", OI."CardCode" AS "Customer Code", OI."CardName" AS "Customer Name", (SELECT SUM(RIN1."Quantity" * (CASE WHEN RIN1."Currency" = 'INR' AND ORIN."DocCur" = 'INR' THEN (RIN1."PriceBefDi") WHEN RIN1."Currency" <> 'INR' AND ORIN."DocCur" <> 'INR' THEN (RIN1."Rate" * RIN1."PriceBefDi") WHEN RIN1."Currency" <> 'INR' AND ORIN."DocCur" = 'INR' THEN (RIN1."Rate" * RIN1."PriceBefDi") WHEN RIN1."Currency" = 'INR' AND ORIN."DocCur" <> 'INR' THEN (ORIN."DocRate" * RIN1."PriceBefDi") END)) FROM RIN1 INNER JOIN ORIN ON RIN1."DocEntry" = ORIN."DocEntry" WHERE RIN1."DocEntry" = oi."DocEntry" GROUP BY RIN1."DocEntry", ORIN."DocCur") * (-1) AS "Value Before Disc", (SELECT SUM(RIN1."Quantity" * (CASE WHEN RIN1."Currency" = 'INR' AND ORIN."DocCur" = 'INR' THEN (RIN1."Price") WHEN RIN1."Currency" <> 'INR' AND ORIN."DocCur" <> 'INR' THEN (RIN1."Rate" * RIN1."Price") WHEN RIN1."Currency" <> 'INR' AND ORIN."DocCur" = 'INR' THEN (RIN1."Rate" * RIN1."Price") WHEN RIN1."Currency" = 'INR' AND ORIN."DocCur" <> 'INR' THEN (ORIN."DocRate" * RIN1."Price") END)) FROM RIN1 INNER JOIN ORIN ON RIN1."DocEntry" = ORIN."DocEntry" WHERE RIN1."DocEntry" = oi."DocEntry" GROUP BY RIN1."DocEntry", ORIN."DocCur") * (-1) AS "Value After Disc", (SELECT (CASE WHEN ORIN."DocCur" = 'INR' THEN SUM(IFNULL(RIN1."LineTotal", 0)) ELSE SUM(IFNULL(RIN1."TotalSumSy", 0)) END) FROM RIN1 INNER JOIN ORIN ON RIN1."DocEntry" = ORIN."DocEntry" WHERE RIN1."DocEntry" = oi."DocEntry" GROUP BY RIN1."DocEntry", ORIN."DocCur") * (-1) AS "Taxable Amt before Ex Ser Tax", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISTax."ISTax", 0) ELSE IFNULL(ISTax."ISTaxFC", 0) END) * (-1) AS "Service Tax ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IExDuty."IExDuty", 0) ELSE IFNULL(IExDuty."IExDutyFC", 0) END) * (-1) AS "Excise Duty ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ItmAED."ItmAED", 0) ELSE IFNULL(ItmAED."ItmAEDFC", 0) END) * (-1) AS "AED ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH."ICeH", 0) ELSE IFNULL(ICeH."ICeHFC", 0) END) + (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH1."ICeH1", 0) ELSE IFNULL(ICeH1."ICeH1FC", 0) END) * (-1) AS "Cess HeCess ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IEXD.IEXD, 0) ELSE IFNULL(IEXD.IEXDFC, 0) END) * (-1) AS "EXD ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IKKCess."IKKCess", 0) ELSE IFNULL(IKKCess."IKKCessFC", 0) END) * (-1) AS "KKCess ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISBCess."ISBCess", 0) ELSE IFNULL(ISBCess."ISBCessFC", 0) END) * (-1) AS "SBCess ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IHSCess_ST."IHSCess_ST", 0) ELSE IFNULL(IHSCess_ST."IHSCess_STFC", 0) END) * (-1) AS "HSCess ST ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISED.ISED, 0) ELSE IFNULL(ISED.ISEDFC, 0) END) * (-1) AS "SED ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICess_ST."ICess_ST", 0) ELSE IFNULL(ICess_ST."ICess_STFC", 0) END) * (-1) AS "ICess ST ItemL", IFNULL(ItmVAT."ItmVAT", 0) * (-1) AS "VAT ItemL", IFNULL(ItmCST."ItmCST", 0) * (-1) AS "CST ItemL", IFNULL(LLFreTot."LLFreTot", 0) * (-1) AS "Total Fright ItemL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISTaxD."ISTax", 0) ELSE IFNULL(ISTaxD."ISTaxFC", 0) END) * (-1) AS "Service Tax ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IExDutyD."IExDuty", 0) ELSE IFNULL(IExDutyD."IExDutyFC", 0) END) * (-1) AS "Excise Duty ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ItmAEDD."ItmAED", 0) ELSE IFNULL(ItmAEDD."ItmAEDFC", 0) END) * (-1) AS "AED ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeHD."ICeH", 0) ELSE IFNULL(ICeHD."ICeHFC", 0) END) + (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH1D."ICeH1", 0) ELSE IFNULL(ICeH1D."ICeH1FC", 0) END) * (-1) AS "Cess HeCess ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IEXDD.IEXD, 0) ELSE IFNULL(IEXDD.IEXDFC, 0) END) * (-1) AS "EXD ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IKKCessD."IKKCess", 0) ELSE IFNULL(IKKCessD."IKKCessFC", 0) END) * (-1) AS "KKCess ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISBCessD."ISBCess", 0) ELSE IFNULL(ISBCessD."ISBCessFC", 0) END) * (-1) AS "SBCess ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IHSCess_STD."IHSCess_ST", 0) ELSE IFNULL(IHSCess_STD."IHSCess_STFC", 0) END) * (-1) AS "HSCess ST ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISEDD.ISED, 0) ELSE IFNULL(ISEDD.ISEDFC, 0) END) * (-1) AS "SED ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICess_STDD."ICess_ST", 0) ELSE IFNULL(ICess_STDD."ICess_STFC", 0) END) * (-1) AS "ICess ST ItemL Fre", IFNULL(ItmVATD."ItmVAT", 0) * (-1) AS "VAT ItemL Fre", IFNULL(ItmCSTDD."ItmCST", 0) * (-1) AS "CST ItemL Fre", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISTaxDoc."ISTax", 0) ELSE IFNULL(ISTaxDoc."ISTaxFC", 0) END) * (-1) AS "Service Tax DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IExDutyDoc."IExDuty", 0) ELSE IFNULL(IExDutyDoc."IExDutyFC", 0) END) * (-1) AS "Excise Duty DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ItmAEDDoc."ItmAED", 0) ELSE IFNULL(ItmAEDDoc."ItmAEDFC", 0) END) * (-1) AS "AED DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeHDoc."ICeH", 0) ELSE IFNULL(ICeHDoc."ICeHFC", 0) END) + (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICeH1Doc."ICeH1", 0) ELSE IFNULL(ICeH1Doc."ICeH1FC", 0) END) * (-1) AS "Cess HeCess DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IEXDDoc.IEXD, 0) ELSE IFNULL(IEXDDoc.IEXDFC, 0) END) AS "EXD DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IKKCessDoc."IKKCess", 0) ELSE IFNULL(IKKCessDoc."IKKCessFC", 0) END) * (-1) AS "KKCess DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISBCessDoc."ISBCess", 0) ELSE IFNULL(ISBCessDoc."ISBCessFC", 0) END) * (-1) AS "SBCess DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(IHSCess_STDoc."IHSCess_ST", 0) ELSE IFNULL(IHSCess_STDoc."IHSCess_STFC", 0) END) * (-1) AS "HSCess ST DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ISEDDoc.ISED, 0) ELSE IFNULL(ISEDDoc.ISEDFC, 0) END) * (-1) AS "SED DocL", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(ICess_STDoc."ICess_ST", 0) ELSE IFNULL(ICess_STDoc."ICess_STFC", 0) END) * (-1) AS "ICess ST DocL", IFNULL(ItmVATDoc."ItmVAT", 0) * (-1) AS "VAT DocL", IFNULL(ItmCSTDoc."ItmCST", 0) * (-1) AS "CST DocL", IFNULL(DocLevFreight."DocLevFreight", 0) * (-1) AS "Total Fright DocL", Oi."DiscPrcnt" AS "Discount Percentage", (CASE WHEN OI."DocCur" = 'INR' THEN IFNULL(OI."DiscSum", 0) ELSE IFNULL(OI."DiscSumSy", 0) END) * (-1) AS "Discount Amount", oi."RoundDif" AS "Round Off", (CASE WHEN oi."DocCur" = 'INR' THEN IFNULL(Oi."DocTotal", 0) ELSE IFNULL(Oi."DocTotalSy", 0) END) * (-1) AS "Doc Total", Oi."Comments" AS "Remarks", OI."DocCur" AS "Currency", oi."DocTotalFC" * (-1) AS "DocTotal FC" FROM "ORIN" oi INNER JOIN RIN1 i1 ON OI."DocEntry" = I1."DocEntry" LEFT OUTER JOIN OSTC O ON O."Code" = I1."TaxCode" LEFT OUTER JOIN ODLN OD ON I1."BaseEntry" = OD."DocEntry" LEFT OUTER JOIN NNM1 N1 ON N1."Series" = OD."Series" LEFT OUTER JOIN NNM1 N2 ON N2."Series" = OI."Series" LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISTax", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISTaxFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 5 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISTax ON I1."DocEntry" = ISTax."DocEntry" AND ISTax."TaxType" IN (5) AND ISTax."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IExDuty", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IExDutyFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -90 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType") AS IExDuty ON I1."DocEntry" = IExDuty."DocEntry" AND IExDuty."TaxType" IN (-90) AND IExDuty."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IEXD", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IEXDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 10 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IEXD ON I1."DocEntry" = IEXD."DocEntry" AND IEXD."TaxType" IN (10) AND IEXD."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", MAX(RIN4."TaxRate") AS "TaxRate", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IKKCess", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IKKCessFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 8 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IKKCess ON I1."DocEntry" = IKKCess."DocEntry" AND IKKCess."TaxType" IN (8) AND IkkCess."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISBCess", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISBCessFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 9 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISBCess ON I1."DocEntry" = ISBCess."DocEntry" AND ISBCess."TaxType" IN (9) AND IsbCess."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IHSCess_ST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IHSCess_STFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -10 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IHSCess_ST ON I1."DocEntry" = IHSCess_ST."DocEntry" AND IHSCess_ST."TaxType" IN (-10) AND IHSCess_ST."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISED", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISEDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -70 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISED ON I1."DocEntry" = ISED."DocEntry" AND ISED."TaxType" IN (-70) AND ISED."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICess_ST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICess_STFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 6 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICess_ST ON I1."DocEntry" = ICess_ST."DocEntry" AND ICess_ST."TaxType" IN (6) AND Icess_ST."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmAED", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmAEDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -80 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmAED ON I1."DocEntry" = ItmAED."DocEntry" AND ItmAED."TaxType" IN (-80) AND ItmAED."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICeH", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICeHFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -60) AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICeH ON I1."DocEntry" = ICeH."DocEntry" AND ICeH."TaxType" IN (-60) AND ICeH."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICeH1", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICeH1FC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -55) AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICeH1 ON I1."DocEntry" = ICeH1."DocEntry" AND ICeH1."TaxType" IN (-55) AND ICeH1."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."RelateType", SUM(RIN4."TaxSum") AS "ITaxTot" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."RelateType") AS ITaxTot ON I1."DocEntry" = ITaxTot."DocEntry" AND ITaxTot."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmVAT", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmVATFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 1 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmVAT ON I1."DocEntry" = ItmVAT."DocEntry" AND ItmVAT."TaxType" IN (1) AND ItmVAT."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmCST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmCSTFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 4 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmCST ON I1."DocEntry" = ItmCST."DocEntry" AND ItmCST."TaxType" IN (4) AND ItmCST."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmVATCST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmVATCSTFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" IN (4,1) AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" = -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmVATCST ON I1."DocEntry" = ItmVATCST."DocEntry" AND ItmVATCST."TaxType" IN (4,1) AND ItmVATCST."RelateType" = 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISTax", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISTaxFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 5 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISTaxDoc ON I1."DocEntry" = ISTaxDoc."DocEntry" AND ISTaxDoc."TaxType" IN (5) AND ISTaxDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IExDuty", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IExDutyFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -90 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType") AS IExDutyDoc ON I1."DocEntry" = IExDutyDoc."DocEntry" AND IExDutyDoc."TaxType" IN (-90) AND IExDutyDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IEXD", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IEXDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 10 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IEXDDoc ON I1."DocEntry" = IEXDDoc."DocEntry" AND IEXDDoc."TaxType" IN (10) AND IEXDDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", MAX(RIN4."TaxRate") AS "TaxRate", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IKKCess", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IKKCessFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 8 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IKKCessDoc ON I1."DocEntry" = IKKCessDoc."DocEntry" AND IKKCessDoc."TaxType" IN (8) AND IkkCessDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISBCess", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISBCessFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 9 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISBCessDoc ON I1."DocEntry" = ISBCessDoc."DocEntry" AND ISBCessDoc."TaxType" IN (9) AND IsbCessDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IHSCess_ST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IHSCess_STFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -10 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IHSCess_STDoc ON I1."DocEntry" = IHSCess_STDoc."DocEntry" AND IHSCess_STDoc."TaxType" IN (-10) AND IHSCess_STDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISED", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISEDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -70 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISEDDoc ON I1."DocEntry" = ISEDDoc."DocEntry" AND ISEDDoc."TaxType" IN (-70) AND ISEDDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICess_ST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICess_STFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 6 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICess_STDoc ON I1."DocEntry" = ICess_STDoc."DocEntry" AND ICess_STDoc."TaxType" IN (6) AND ICess_STDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmAED", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmAEDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -80 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmAEDDoc ON I1."DocEntry" = ItmAEDDoc."DocEntry" AND ItmAEDDoc."TaxType" IN (-80) AND ItmAEDDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICeH", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICeHFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -60) AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICeHDoc ON I1."DocEntry" = ICeHDoc."DocEntry" AND ICeHDoc."TaxType" IN (-60) AND ICeHDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICeH1", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICeH1FC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -55) AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICeH1Doc ON I1."DocEntry" = ICeH1Doc."DocEntry" AND ICeH1Doc."TaxType" IN (-55) AND ICeH1Doc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."RelateType", SUM(RIN4."TaxSum") AS "ITaxTot" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."RelateType") AS ITaxTotDoc ON I1."DocEntry" = ITaxTotDoc."DocEntry" AND ITaxTotDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmVAT", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmVATFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 1 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmVATDoc ON I1."DocEntry" = ItmVATDoc."DocEntry" AND ItmVATDoc."TaxType" IN (1) AND ItmVATDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmCST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmCSTFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 4 AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmCSTDoc ON I1."DocEntry" = ItmCSTDoc."DocEntry" AND ItmCSTDoc."TaxType" IN (4) AND ItmCSTDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmVATCST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmVATCSTFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" IN (4,1) AND RIN4."RelateType" = 3 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmVATCSTDoc ON I1."DocEntry" = ItmVATCSTDoc."DocEntry" AND ItmVATCSTDoc."TaxType" IN (4,1) AND ItmVATCSTDoc."RelateType" = 3 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISTax", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISTaxFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 5 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISTaxD ON I1."DocEntry" = ISTaxD."DocEntry" AND ISTaxD."TaxType" IN (5) AND ISTaxD."RelateType" <> 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IExDuty", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IExDutyFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -90 AND RIN4."GroupNum" = -1 AND RIN4."RelateType" = 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType") AS IExDutyD ON I1."DocEntry" = IExDutyD."DocEntry" AND IExDutyD."TaxType" IN (-90) AND IExDutyD."RelateType" <> 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IEXD", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IEXDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 10 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType") AS IEXDD ON I1."DocEntry" = IEXDD."DocEntry" AND IEXDD."TaxType" IN (10) AND IEXDD."RelateType" <> 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", MAX(RIN4."TaxRate") AS "TaxRate", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IKKCess", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IKKCessFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 8 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IKKCessD ON I1."DocEntry" = IKKCessD."DocEntry" AND IKKCessD."TaxType" IN (8) AND IKKCessD."RelateType" <> 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISBCess", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISBCessFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 9 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISBCessD ON I1."DocEntry" = ISBCessD."DocEntry" AND ISBCessD."TaxType" IN (9) AND ISBCessD."RelateType" <> 1 LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "IHSCess_ST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "IHSCess_STFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -10 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS IHSCess_STD ON I1."DocEntry" = IHSCess_STD."DocEntry" AND IHSCess_STD."TaxType" IN (-10) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ISED", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ISEDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -70 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ISEDD ON I1."DocEntry" = ISEDD."DocEntry" AND ISEDD."TaxType" IN (-70) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICess_ST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICess_STFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 6 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICess_STDD ON I1."DocEntry" = ICess_STDD."DocEntry" AND ICess_STDD."TaxType" IN (6) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmAED", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmAEDFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = -80 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmAEDD ON I1."DocEntry" = ItmAEDD."DocEntry" AND ItmAEDD."TaxType" IN (-80) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICeH", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICeHFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -60) AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICeHD ON I1."DocEntry" = ICeHD."DocEntry" AND ICeHD."TaxType" IN (-60) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ICeH1", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ICeH1FC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE (OSTT."AbsId" = -55) AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ICeH1D ON I1."DocEntry" = ICeH1D."DocEntry" AND ICeH1D."TaxType" IN (-55) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."RelateType", SUM(RIN4."TaxSum") AS "ITaxTot" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."RelateType") AS ITaxTotD ON I1."DocEntry" = ITaxTotD."DocEntry" LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmVAT", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmVATFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 1 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmVATD ON I1."DocEntry" = ItmVATD."DocEntry" AND ItmVATD."TaxType" IN (1) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmCST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmCSTFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" = 4 AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmCSTDD ON I1."DocEntry" = ItmCSTDD."DocEntry" AND ItmCSTDD."TaxType" IN (4) LEFT OUTER JOIN (SELECT RIN4."DocEntry", RIN4."staType" AS "TaxType", RIN4."RelateType", SUM(IFNULL((RIN4."TaxSum"), 0)) AS "ItmVATCST", SUM(IFNULL((RIN4."TaxSumSys"), 0)) AS "ItmVATCSTFC" FROM RIN4 INNER JOIN OSTT ON RIN4."staType" = OSTT."AbsId" WHERE OSTT."AbsId" IN (4,1) AND RIN4."GroupNum" <> -1 AND RIN4."RelateType" <> 1 AND RIN4."ExpnsCode" <> -1 GROUP BY RIN4."DocEntry", RIN4."staType", RIN4."RelateType", RIN4."GroupNum") AS ItmVATCSTDD ON I1."DocEntry" = ItmVATCSTDD."DocEntry" AND ItmVATCSTDD."TaxType" IN (4,1) LEFT OUTER JOIN (SELECT RIN2."DocEntry", SUM(CASE WHEN RIN2."FixCurr" = 'INR' THEN IFNULL((RIN2."LineTotal"), 0) ELSE IFNULL((RIN2."TotalSumSy"), 0) END) AS "LLFreTot" FROM RIN2 WHERE cast(RIN2."ExpnsCode" as varchar) <> '' GROUP BY RIN2."DocEntry") AS LLFreTot ON I1."DocEntry" = LLFreTot."DocEntry" LEFT OUTER JOIN (SELECT RIN3."DocEntry", SUM(CASE WHEN RIN3."FixCurr" = 'INR' THEN IFNULL((RIN3."LineTotal"), 0) ELSE IFNULL((RIN3."TotalSumSy"), 0) END) AS "DocLevFreight" FROM RIN3 WHERE cast(RIN3."ExpnsCode" as varchar) <> '' GROUP BY RIN3."DocEntry") AS DocLevFreight ON I1."DocEntry" = DocLevFreight."DocEntry" LEFT OUTER JOIN (SELECT "CardCode", "Address", "TaxId0", "TaxId1", "TaxId2", "TaxId3" FROM CRD7 crd7 WHERE "Address" <> '' AND ("AddrType" = 'S')) AS crd7 ON OI."CardCode" = crd7."CardCode" AND OI."ShipToCode" = crd7."Address" WHERE OI.CANCELED = 'N'

) as sr
group by sr."DEL No",sr."Invoice No",sr."DEL Date",sr."Invoice Date",sr."Currency",sr."Customer Code",sr."Customer Name",sr."Customer Ref Date",--sr.Total_Amount_before_Discount,
sr."Value Before Disc",
sr."DocEntry",
sr."Taxable Amt before Ex Ser Tax",sr."Value After Disc",
sr."Service Tax ItemL",sr."Excise Duty ItemL",sr."AED ItemL",sr."Cess HeCess ItemL",sr."EXD ItemL",sr."KKCess ItemL",sr."SBCess ItemL",
sr."HSCess ST ItemL",sr."SED ItemL",sr."ICess ST ItemL",sr."VAT ItemL",sr."CST ItemL",
sr."Total Fright ItemL",
sr."Total Fright DocL",
sr."Service Tax ItemL Fre",sr."Excise Duty ItemL Fre",sr."AED ItemL Fre",sr."Cess HeCess ItemL Fre",sr."EXD ItemL Fre",sr."KKCess ItemL Fre",sr."SBCess ItemL Fre",
sr."HSCess ST ItemL Fre",sr."SED ItemL Fre",sr."ICess ST ItemL Fre",sr."VAT ItemL Fre",sr."CST ItemL Fre",

sr."Service Tax DocL",sr."Excise Duty DocL",sr."AED DocL",sr."Cess HeCess DocL",sr."EXD DocL",sr."KKCess DocL",sr."SBCess DocL",
sr."HSCess ST DocL",sr."SED DocL",sr."ICess ST DocL",sr."VAT DocL",sr."CST DocL",
sr."Round Off",
sr."Discount Percentage",
sr."Discount Amount",
sr."Doc Total",
sr."Remarks",
sr."DocTotal FC"
order by sr."Invoice Date"



